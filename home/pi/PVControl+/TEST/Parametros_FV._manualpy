#!/usr/bin/python3
# -*- coding: utf-8 -*-
# ------------------------------------------
######      PARAMETROS INSTALACION 
# ------------------------------------------

###### Parametros Batería
AH = 1200.0         # Capacidad C20
CP = 1.107          # Indice Peukert
EC = 1.0            # Eficiencia Carga
vsis = 2            # Voltaje sistema - 1=12V  2=24V   4=48V
vflotacion = 13.7   # Valor por defecto de flotacion a 25ºC a 12V (no se usa por ahora)
# -----------------------------------------------

##### Parametros sensores

Vbat_sensor   = 'ADS'     # ADS, HIBRIDO, MONITOR
Vplaca_sensor = 'ADS'     # ADS, HIBRIDO

Ibat_sensor   = 'ADS'     # ADS, HIBRIDO, MONITOR
Iplaca_sensor = 'ADS'     # ADS, HIBRIDO, MONITOR, ADS+HIBRIDO

Vaux_sensor   = ''     # ADS, dejar  '' para no usar

###### Parametros ADS1115
SHUNT1 = 500.0/50         # Shunt Ibat (Amperios/mV)
SHUNT2 = 300.0/75         # Shunt Iplaca (Amperios/mV)

#  - Tabla de Valores maximos segun ganancias ADS1115
#  - 2/3 = 6.144V
#  -   1 = 4.096V
#  -   2 = 2.048V
#  -   4 = 1.024V
#  -   8 = 0.512V
#  -  16 = 0.256V

# Valor Voltaje divisor = Ventrada*R1/(R1+R2)
#Vbat
RES0 = (68+1.5)/1.5 #* 1.01421     # Divisor tension Vbat
RES0_gain = 2                   # Fondo escala 1=4,096 - 2=2.048
#Vaux
RES1 = (68+1.5)/1.5 #* 1.02735     # Divisor tension Vaux
RES1_gain = 2                   # Fondo escala 1=4,096 - 2=2.048
#Vplaca
RES2 = (68+1.5)/1.5 #* 1.02618     # Divisor tension Vplaca
RES2_gain = 2                   # Fondo escala 1=4,096 - 2=2.048
#V...
RES3 = (68+1.5)/1.5 #* 1.02113     # Divisor tension ....
RES3_gain = 2                   # Fondo escala 1=4,096 - 2=2.048

# -----------------------------------------------


###### Parametros Mensaje error lectura incoherente
vbat_max = 33
vbat_min = 20
vaux_max = 14
vaux_min = -1
vplaca_max = 90
vplaca_min = -5

ibat_max = 150
ibat_min = -200
iplaca_max = 200
iplaca_min = -1

temp_max = 50
temp_min = -10

t_muestra_max =6  # valor para grabar en el log si tarda mas el bucle en ejecutarse
# -----------------------------------------------


###### Parametros Base de Datos
servidor = 'localhost'
usuario = 'rpi' 
clave = 'fv' 
basedatos = 'control_solar'
# -----------------------------------------------

###### MQTT
mqtt_broker  = 'localhost'
mqtt_puerto  = 1883
mqtt_usuario = 'rpi'
mqtt_clave   = 'fv'

pub_diver = 0 # publica datos ejecucion diver en "PVControl/Opcion/Diver"
pub_time  = 0  # publica datos de tiempo de ejecucion en "PVControl/Opcion/Time"
#mqtt_broker = 'iot.eclipse.org'
# -----------------------------------------------

###### Telegram
usar_telegram = 1 # 1 para usar  ..... 0 para no usar
TOKEN ='565929423:AAF7JDdEQCVBYkKAtzXZ-xzGhyH0VpeoG9A'# bot PVControl ...cambiar por el que cada uno de de alta
#TOKEN ='271143566:AAGls8PEvk3xw8q8U0jFx7pFbnPDA8K_9i4' # fv_bot ...Mleon 

# ID de Usuarios autorizados a mandar mensajes, los msg periodicos se mandan al primer declarado
Aut = [-182453084,-369746618,282936808] # Grupo PVControl
#Aut = [-171541706]# FV_Diario
cid_alarma = -369746618 #282936808 # Id Telegram a donde se enviara la foto/video de alarma

msg_periodico_telegram = 0 # 1 = Manda un mensaje resumen por Telegram cada Hora -- 0 = No manda mensaje

#-------- Vigilancia por Camara con Motion y Clarifai
motion_telegram = 1 # 1 = Envia foto deteccion a Telegram
motion_clarifai = 1 # activa reconocimiento por Clarifai
api_key = '346833e142374f2aa871b330773976d7' # Key Clarifai
workflow_id = 'PVControl-WF1' # Nombre del Workflow creado en Clarifai

# fconfiguración horaria para motion
# dias de la semana 1-7. Horas 24 bits 0=no grabar 1=si
horario_alarma = {
    1:'111111110000000000000000',
    2:'111111110000000000000000',
    3:'111111110000000000000000',
    4:'111111110000000000000000',
    5:'111111110000000000000000',
    6:'111111111000000000000000',
    7:'111111111000000000000000'}

# -----------------------------------------------

###### PV_OUTPUT
usar_pvoutput = 0 # 1 para usar  ..... 0 para no usar
pvoutput_key  = "04b4b3fd0905650dd88abf3ce31cb18819d69a3a" # 
pvoutput_id   = "44444" 
# -----------------------------------------------

###### Simulacion
simular = 1  # Simulacion datos FV --- 1 para simular....0 para no simular
simular_reles = 1 # Simular reles fisicos
# -----------------------------------------------

###### Sensor Temperatura (DS18B20)
sensortemperatura = 0   # Poner a 0 si no se ha instalado el DS18B20
indice_sensortemperatura = 0 # si hay mas de un sensor hay que definir el que queremos guardar
# -----------------------------------------------

###### Multiplexor
mux = 0      # Poner a 1 si existe un multiplexor de 16 canales
# -----------------------------------------------

###### HIBRIDO

## ATENCION ser congruente con lo que se ha puesto en el apartado de sensores
## Si algun sensor (Vbat, Vplaca,...)  usa el Hibrido o se quiere guardar en BD en la tabla 'Hibrido'
## se debe poner usar_hibrido = 1

usar_hibrido = 0 #1 para leer datos Hibrido ..... 0 para no usar

dev_hibrido ='/dev/hidraw0'
usar_crc = 1 # 1 para comandos del hibrido con CRC... 0 para no añadir CRC

grabar_datos_hibrido = 1 # 1 = Graba la tabla Hibrido... 0 = No graba

iplaca_hibrido_max = 80
iplaca_hibrido_min = 0


# -----------------------------------------------

###### Pantalla OLED
OLED_salida1 =[0,1,2,3] # secuencia de pantallazos modelo 1, 2, 3 o 4...0=Logo
OLED_salida2 =[4] # secuencia de pantallazos modelo 1, 2, 3 o 4...0=Logo

# -----------------------------------------------

